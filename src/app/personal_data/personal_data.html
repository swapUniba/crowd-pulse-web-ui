<md-content layout-padding flex>
    <h2>Personal Data - Control Panel</h2>

    <div ng-if="user.devices || user.devices.length > 0">
        <md-content class="md-padding" layout-xs="column" layout="column">
            <h3>User: {{user.displayName}}</h3>

            <md-input-container>
                <label>Please select a device</label>
                <md-select ng-change="vm.onDeviceIdSelected()" ng-model="vm.selectedDeviceId">
                    <md-option  ng-value="device.deviceId" ng-repeat="device in user.devices">
                        {{ device.deviceId }}
                    </md-option>
                </md-select>
            </md-input-container>

            <div ng-if="vm.selectedDeviceId && vm.loginSuccess">
                <div ng-if="user.deviceConfigs && vm.selectedDeviceConfig">
                    <div ng-repeat="(key, val) in vm.selectedDeviceConfig">
                        <div layout="row" ng-if="vm.startWith(key, 'read')">
                            <div flex="20">
                                <md-switch ng-model="vm.selectedDeviceConfig[key]"
                                           ng-change="vm.onSwitchPressed()"
                                           aria-label="{{key}}"
                                           ng-true-value="1" ng-false-value="0">
                                    {{key}}
                                </md-switch>
                            </div>

                            <div flex="80">

                                <!-- slider for account type data -->
                                <div ng-if="key == 'readAccounts'" layout="row">
                                    <md-slider flex="70"
                                               ng-change="vm.onSliderMoved(key, vm.timeAccounts, vm.timeAccountsAllowed)"
                                               md-discrete ng-model="vm.timeAccounts"
                                               step="1" min="1" max="24" aria-label="{{key}}"
                                               ng-disabled="vm.selectedDeviceConfig[key] == 0">
                                    </md-slider>
                                    <div flex="30" layout layout-align="center center">
                                        <span class="md-body-1">get account data every {{vm.timeAccounts}} hours</span>
                                    </div>
                                </div>

                                <!-- slider for gps type data -->
                                <div ng-if="key == 'readGPS'" layout="row">
                                    <md-slider flex="70"
                                               ng-change="vm.onSliderMoved(key, vm.timeGPS, vm.timeGPSAllowed)"
                                               md-discrete ng-model="vm.timeGPS"
                                               step="1" min="1" max="60" aria-label="{{key}}"
                                               ng-disabled="vm.selectedDeviceConfig[key] == 0">
                                    </md-slider>
                                    <div flex="30" layout layout-align="center center">
                                        <span class="md-body-1">get GPS data every {{vm.timeGPS}} minutes</span>
                                    </div>
                                </div>

                                <!-- slider for netstats type data -->
                                <div ng-if="key == 'readNetStats'" layout="row">
                                    <md-slider flex="70"
                                               ng-change="vm.onSliderMoved(key, vm.timeNetStats, vm.timeNetStatsAllowed)"
                                               md-discrete ng-model="vm.timeNetStats"
                                               step="1" min="1" max="24" aria-label="{{key}}"
                                               ng-disabled="vm.selectedDeviceConfig[key] == 0">
                                    </md-slider>
                                    <div flex="30" layout layout-align="center center">
                                        <span class="md-body-1">get net statistics data every {{vm.timeNetStats}} hours</span>
                                    </div>
                                </div>

                                <!-- slider for contact type data -->
                                <div ng-if="key == 'readContact'" layout="row">
                                    <md-slider flex="70"
                                               ng-change="vm.onSliderMoved(key, vm.timeContact, vm.timeContactAllowed)"
                                               md-discrete ng-model="vm.timeContact"
                                               step="1" min="1" max="24" aria-label="{{key}}"
                                               ng-disabled="vm.selectedDeviceConfig[key] == 0">
                                    </md-slider>
                                    <div flex="30" layout layout-align="center center">
                                        <span class="md-body-1">get contacts data every {{vm.timeContact}} hours</span>
                                    </div>
                                </div>

                                <!-- slider for display type data, slider disabled by default -->
                                <div ng-if="key == 'readDisplay'" layout="row">
                                    <md-slider flex="70"
                                               ng-change="vm.onSliderMoved(key, vm.timeDisplay, vm.timeDisplayAllowed)"
                                               md-discrete ng-model="vm.timeDisplay"
                                               step="1" min="1" max="24" ng-disabled="true" aria-label="{{key}}">
                                    </md-slider>
                                    <div flex="30" layout layout-align="center center">
                                        <span class="md-body-1">get display data </span>
                                    </div>
                                </div>

                                <!-- slider for app info type data, slider disabled by default -->
                                <div ng-if="key == 'readAppInfo'" layout="row">
                                    <md-slider flex="70"
                                               ng-change="vm.onSliderMoved(key, vm.timeAppInfo, vm.timeAppInfoAllowed)"
                                               md-discrete ng-model="vm.timeAppInfo"
                                               step="1" min="1" max="24" ng-disabled="true" aria-label="{{key}}">
                                    </md-slider>
                                    <div flex="30" layout layout-align="center center">
                                        <span class="md-body-1">get appinfo data </span>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <md-button class="md-raised md-primary" ng-click="vm.sendConfiguration()">Save</md-button>
                </div>
                <div ng-if="!vm.selectedDeviceConfig || vm.selectedDeviceConfig == ''">
                    <p>Error! No configuration stored for this device.</p>
                </div>
            </div>
        </md-content>
    </div>

    <div ng-if="!user.devices || user.devices.length == 0">
        <p>No devices linked. Please download the CrowdPulse App.</p>
    </div>

</md-content>